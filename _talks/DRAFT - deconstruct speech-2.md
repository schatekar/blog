## Last Mile Security

As API developers we often tend to focus more on building what we think are the most secure APIs. We often fail to recognise the fact that we have very little control over how the consumers of the API are going to treat the API keys, secrets and tokens that we issue. 

In this talk, I will go over the story of an API developer. Let's call him Joe. Joe has developed a public API for the first time. Having built internal APIs in past, Joe's first choice to secure the new APIs is to use API keys. But Joe soon realises that he has little control over how the consumers of the API are handling this key. If the key gets stolen then it would probably be a long time before Joe can even know. Joe does some digging and figures out that APIs can be better secured using a token-based system like OAuth 2.0 or OpenId Connect. Joe still cannot control how the tokens get handled but Joe is able to control the damage by limiting the time that tokens are valid for. It just so happens, Joe now has an API consumer in the form of a mobile app. The developers of this App want tokens to live longer so that they can offer a seamless user experience. Joe is back to square one now. It would be long  before Joe can find out if these long lived token are stolen. 

Joe wants to be able to do more to protect his APIs than just asking the front-end developers to follow the best security practices. there are a few things Joe can do. For browser-based clients, Joe can accept only the requests where token is present in both a cookie and the header of the request. This will protect the API in case of there being an XSS/CSRF vulnerability in the client application. For the smartphone clients, John can setup a cryptographic challenge .. 

## Option 2

Software are designed radically differently these days. Mobile apps, single page applications, voice applications are becoming common. Consequently, we are developing more APIs than we ever developed before. More and more developers are producing APIs open for external consumption. Such use cases demand that API security be handled differently. We have moved from static key based authentication to token based authentication. We have moved from using custom token schemes to standards like OAuth 2.0 and OpenId Connect. However, the client applications consumings the APIs are being run in more and more untrusted environments. When a single page application gets hold of an API token, the API developer has no control over how this token is being protected while in the browser. APIs using bearer token authentication schemes are susceptible to misuse by someone who manages to steal a token because the client application did not store it securely. Even worse, because the token service was attacked to steal tokens. API developers need more weapons in their arsenal to protect APIs in such situations. 

In this talk, I will go over different mechanisms used to protect APIs, which aspect of the API security do they meet and where do they fall short. I will discuss different security threats posed by the new breed of client applications. Most importantly, I will talk about security mechanisms that will help API developers protect APIs without having to worry about how untrusted client applications are handling tokens. These range from old knowledge like correct use of cookies and CORS settings to latest guidelines like proof of possession tokens and challenge-response schemes. 

I call this last mile security. 

## Option 3

### What is the topic?
My talk is about API security in general with emphasis on techniques to protect APIs when secrets or tokens are issued to public clients. Public clients are applications that run in an untrusted environment. Examples include single page applications, mobile applications etc. 

In this talk, I will go over different mechanisms used to protect APIs. I will discuss how these mechanisms work, which aspect of the API security do they meet and where do they fall short. I will also talk about different security threats posed by the public clients. Most importantly, I will talk about options that will help API developers protect APIs without having to worry about how public clients are handling tokens. These options range from old knowledge like correct use of cookies and CORS settings to latest guidelines like proof of possession tokens and challenge-response schemes.

### Why is it interesting and important at the same time?
There is a good understanding of general API security techniques among the developer community. However, I have noticed that most developers would not concern themselves with how untrusted client applications are handling the secrets or tokens issued to them. Single page applications are becoming the default choice when building a web application these days. These applications access APIs directly from the browser and rely on browser supplied storage options to store the sensitive information.  Vulnerabilities like XSS/CSRF in these applications mean that secrets or tokens may be stolen. Redirection attacks on identity servers also playing a part in this. Abundant use of unverified npm packages may result in XSS attack. If APIs are relying on bearer authentication schemes then we are giving the bad guys a free ride. Anyone in possession of the token is able to successfully access the API. I believe that API developers must understand the environments in which their client applications are being developed and run. They need to be able to introduce additional security layers that protect their APIs against threats not under their control. 
